<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>ðŸ’Ždiamond</title>
	
	<link rel="stylesheet" href="css/base.css">
	<link rel="stylesheet" href="css/index.css">
</head>
<body>
	<main class='todo-app'></main>
	
	<script src='getData.js'></script>
	<script src='../diamond.js'></script>
	
	<template id='todo'>
		<ul class='todo-list'>
			<section-slot data-bind="s1">
			<li>
				<div class="view">
					<input data-bind="p1" class="toggle" type="checkbox">
					<label><text-slot data-bind="t1"></text-slot></label>
					<button class="destroy"></button>
				</div>
				<input data-bind="p2" class="edit" value="">
			</li>
			</section-slot>
		</ul>
	</template>
	
	<script>
		// console.profile('render')
		var Binder = Diamond.Binder;
		
		function getTemplate() {
			
			var binder = new Binder();
			binder.section( 's1', { type: 'for', ref: 'items' } );
			binder.property( 'p1', 'checked', { ref: 'done' } );
			binder.property( 'p2', 'value', { ref: 'name' } );
			binder.text( 't1', { ref: 'name' } );
			
			var fragment = Diamond.clean( document.getElementById('todo').content.cloneNode( true ) );
				
			return {
				fragment,
				bindings: binder.bindings
			};
		}
		
		console.time( 'total' );
		
		console.time( 'init' );
		const el = document.querySelector( 'main' );
		const data = { items: getData() };
		const template = getTemplate();
		console.timeEnd( 'init' );
		
		console.time( 'render' );
		new Diamond({ el, template, data });
		console.timeEnd( 'render' );
		
		console.timeEnd( 'total' );
		
	</script>
</body>
</html>